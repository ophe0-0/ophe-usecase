---
- name: Pre Health Check
  hosts: all

  tasks:
    - name: Gather Facts on VM
      ansible.builtin.gather_facts:
        all_nodes: "{{ all_nodes | default([]) }}" 
      
      # - name: Check disk space usage
      #   ansible.builtin.command:
      #     cmd: df -h

    - name: Generate a Post-Patch HTML report
      ansible.builtin.template:
        src: report.j2
        dest: /tmp/postreport.html
      vars:
        nodes_data: "{{ all_nodes }}"
      delegate_to: localhost
      


